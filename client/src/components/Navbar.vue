<script setup>
import { ref, onMounted, watch, computed, nextTick, onUnmounted } from 'vue'
import { useRouter, useRoute } from 'vue-router'
import { useUserStore } from '@/stores/user.js'
import { message } from '@/utils/message.js'
import AuthManager from '@/utils/auth.js'

const router = useRouter()
const route = useRoute()
const userStore = useUserStore()

// ==================== 1. 核心响应式状态 ====================
const showUserMenu = ref(false)
const activeDropdown = ref(null)
const navbarHeight = ref(80)
const prevScrollY = ref(0)
const scrollY = ref(0) // 记录当前滚动高度

// 控制导航栏物理位置的显隐 (基于滚动方向)
const isNavbarVisible = ref(true)
// 鼠标是否在感应区/导航栏内
const isMouseOnNavbar = ref(false)

// ==================== 2. 智能交互计算逻辑 (核心优化) ====================

/**
 * 逻辑 A: 是否显示毛玻璃背景
 * 规则：鼠标移入时显示 OR 页面向下滚动超过 10px 时显示
 */
const shouldShowBackground = computed(() => {
  return isMouseOnNavbar.value || scrollY.value > 10
})

/**
 * 逻辑 B: 导航栏本体是否显示在视野内
 * 规则：鼠标停留在感应区时强制显示 (实现隐藏状态下的“主动召唤”)
 * 否则遵循滚动逻辑 (向上滚动出现，向下滚动避让)
 */
const shouldShowNavbar = computed(() => {
  if (isMouseOnNavbar.value) return true
  return isNavbarVisible.value
})

// ==================== 3. 响应式用户数据绑定 ====================
const isLoggedIn = computed(() => userStore.isLoggedIn)
const isAdmin = computed(() => userStore.user?.role === 'admin')
const username = computed(() => userStore.user?.username || 'Guest')
const userAvatar = computed(() => userStore.user?.avatar || '')
const nickname = computed(() => userStore.user?.nickname || userStore.user?.username || '用户')
const avatarText = computed(() => nickname.value ? nickname.value.charAt(0).toUpperCase() : '?')
const handle = computed(() => userStore.user?.username ? '@' + userStore.user.username.toLowerCase().replace(/\s+/g, '') : '')

const handleAvatarError = (e) => {
  e.target.src = 'https://w.wallhaven.cc/full/9o/wallhaven-9oog5d.jpg'
}

// ==================== 4. 导航显隐交互函数 ====================
const handleMouseEnter = () => {
  isMouseOnNavbar.value = true
  // 鼠标移入时，确保导航栏立即滑入视野
  isNavbarVisible.value = true
}

const handleMouseLeave = () => {
  isMouseOnNavbar.value = false
  activeDropdown.value = null
}

const onScroll = () => {
  if (isMouseOnNavbar.value) return // 鼠标操作期间不触发滚动避让逻辑

  requestAnimationFrame(() => {
    const currentScrollY = window.scrollY
    const scrollDelta = currentScrollY - prevScrollY.value
    scrollY.value = currentScrollY

    // 在最顶部始终显示
    if (currentScrollY <= navbarHeight.value) {
      isNavbarVisible.value = true
    }
    // 向下滚动且滚出一段距离后隐藏 (避让)
    else if (scrollDelta > 10 && currentScrollY > navbarHeight.value + 50) {
      isNavbarVisible.value = false
    }
    // 向上滚动时显示
    else if (scrollDelta < -10) {
      isNavbarVisible.value = true
    }
    prevScrollY.value = currentScrollY
  })
}

// ==================== 5. 账号切换与登录逻辑 (无缝切换优化) ====================
const switchAccount = () => {
  showUserMenu.value = false
  // 标记“正在切换”，不清除当前 Token，保持旧账号直到新账号成功登录
  sessionStorage.setItem('isSwitchingAccount', 'true')
  router.push('/login')
  message.info('请登录另一个账号')
}

const handleUserLogin = (event) => {
  const isSwitching = sessionStorage.getItem('isSwitchingAccount') === 'true'

  if (event.detail.user && event.detail.token) {
    // 新账号登录数据覆盖
    userStore.login(event.detail.user, event.detail.token)

    if (isSwitching) {
      message.success(`已切换至账号: ${event.detail.user.nickname || event.detail.user.username}`)
      sessionStorage.removeItem('isSwitchingAccount')
    }
  }
}

// ==================== 6. 其他业务功能 (登出、主题、位置) ====================
const handleLogout = () => {
  if (confirm('确定要退出登录吗？')) {
    AuthManager.logout()
    userStore.logout()
    window.dispatchEvent(new CustomEvent('user-logout'))
    router.push('/login').then(() => window.location.reload())
  }
}

// 初始化 isDark
const isDark = ref(document.documentElement.classList.contains('dark'))

const toggleTheme = () => {
  isDark.value = !isDark.value
  const theme = isDark.value ? 'dark' : 'light'

  // 1. 操作 DOM：给 <html> 增加或删除 .dark 类
  document.documentElement.classList.toggle('dark', isDark.value)

  // 2. 持久化
  localStorage.setItem('theme', theme)

  // 3. 细节：给 body 增加一个临时 class 处理过渡动画
  // 这样可以防止在拖动进度条等频繁重绘时性能抖动
  document.body.classList.add('theme-transitioning')
  setTimeout(() => {
    document.body.classList.remove('theme-transitioning')
  }, 400)
}

// 供菜单点击调用的组合函数
const toggleThemeAndCloseMenu = () => {
  toggleTheme()
  showUserMenu.value = false
}

const handleLocationClick = () => {
  if (!isLoggedIn.value) return message.warning('请先登录')
  userStore.location ? userStore.refreshLocation() : userStore.getLocation()
}

// 下拉菜单防抖
let closeTimer = null
const handleNavEnter = (name) => { clearTimeout(closeTimer); activeDropdown.value = name }
const handleNavLeave = () => { closeTimer = setTimeout(() => activeDropdown.value = null, 150) }

// ==================== 1. 导航数据 (此处保持您的 navItems 数组即可) ====================
const navItems = [
  {
    name: '首页',
    path: '/',
    isDropdown: false,
    viewBox: '0 0 1024 1024',
    paths: [
      { d: 'M68.352 660.906667v172.202666c27.050667 10.154667 64.938667 16.384 106.922667 16.384 41.984 0 79.872-6.314667 106.922666-16.384V660.906667L175.274667 572.672 68.352 660.906667z', fill: '#FFBCC5' },
      { d: 'M74.154667 835.157333c5.376 1.792 11.008 3.413333 17.066666 4.949334V642.048l-22.869333 18.858667v172.202666c1.706667 0.682667 3.498667 1.28 5.290667 1.877334 0.170667 0.085333 0.341333 0.170667 0.512 0.170666z', fill: '#FFE3E3' },
      { d: 'M225.962667 614.485333v231.765334c10.581333-1.365333 20.650667-3.242667 29.952-5.376l1.024-0.256c1.877333-0.426667 3.669333-0.938667 5.461333-1.365334 0.512-0.170667 1.024-0.256 1.621333-0.426666 1.621333-0.426667 3.157333-0.853333 4.693334-1.28l1.792-0.512c1.536-0.426667 2.986667-0.938667 4.437333-1.365334 0.512-0.170667 1.109333-0.341333 1.621333-0.512 1.962667-0.682667 3.84-1.28 5.717334-2.048V660.906667l-56.32-46.421334z', fill: '#FF9797' },
      { d: 'M294.656 693.845333L175.274667 595.285333l-119.466667 98.56-22.186667-26.88 141.653334-116.906666 141.568 116.906666z', fill: '#05A336' },
      { d: 'M175.274667 550.058667v45.226666l119.381333 98.56 22.186667-26.88z', fill: '#05A336' },
      { d: 'M134.997333 729.6v117.504c12.117333 1.536 25.088 2.389333 38.656 2.389333 9.216 0 18.261333-0.426667 26.88-1.109333V730.453333c-9.301333 1.024-19.114667 1.621333-29.354666 1.621334-12.8 0-25.002667-0.853333-36.181334-2.474667z', fill: '#FFF1B8' },
      { d: 'M179.797333 849.493333c7.082667-0.170667 13.994667-0.512 20.650667-1.109333V730.453333c-6.656 0.768-13.568 1.194667-20.650667 1.450667v117.589333z', fill: '#FCE665' },
      { d: 'M237.738667 347.989333l-28.672-4.096-12.629334-25.002666-12.629333 25.002666-28.672 4.096 20.736 19.712-4.864 27.648 25.429333-13.056L221.866667 395.434667l-4.864-27.648 20.736-19.797334z', fill: '#FFBC00' },
      { d: 'M217.002667 367.786667l4.864 27.648-25.429334-13.056v-63.488l12.714667 25.002666 28.586667 4.096z', fill: '#E59200' },
      { d: 'M88.576 252.757333l-34.218667 19.968-34.730666-16.042666 7.68 37.546666L0 322.986667l39.082667 3.498666 18.261333 33.792 16.128-35.584 38.314667-7.594666-28.757334-25.514667 5.546667-38.826667z', fill: '#FCE665' },
      { d: 'M83.114667 291.584l28.757333 25.514667-38.314667 7.68-53.930666-68.096 34.816 16.128 34.133333-20.053334z', fill: '#FFBC00' },
      { d: 'M192 404.565333h8.96v109.653334H192z', fill: '#7CE597' },
      { d: 'M270.250667 225.536m-16.64 0a16.64 16.64 0 1 0 33.28 0 16.64 16.64 0 1 0-33.28 0Z', fill: '#05A336' },
      { d: 'M160.597333 514.218667l-13.482666-0.426667c3.754667-117.333333-68.010667-168.192-68.693334-168.704l0.682667 0.341333 5.461333-12.288c0.768 0.341333 80.042667 53.504 76.032 181.077334z', fill: '#7CE597' },
      { d: 'M100.522667 435.029333m-11.349334 0a11.349333 11.349333 0 1 0 22.698667 0 11.349333 11.349333 0 1 0-22.698667 0Z', fill: '#05A336' },
      { d: 'M741.802667 660.906667v172.202666c27.050667 10.154667 64.938667 16.384 106.922666 16.384 41.984 0 79.872-6.314667 106.922667-16.384V660.906667L848.725333 572.672 741.802667 660.906667z', fill: '#FFBCC5' },
      { d: 'M747.605333 835.157333c5.376 1.792 11.008 3.413333 17.066667 4.949334V642.048l-22.869333 18.858667v172.202666c1.706667 0.682667 3.498667 1.28 5.290666 1.877334 0.170667 0.085333 0.341333 0.170667 0.512 0.170666z', fill: '#FFE3E3' },
      { d: 'M899.413333 614.485333v231.765334c10.581333-1.365333 20.650667-3.242667 29.952-5.376l1.024-0.256c1.877333-0.426667 3.669333-0.938667 5.461334-1.365334 0.512-0.170667 1.024-0.256 1.621333-0.426666 1.621333-0.426667 3.157333-0.853333 4.693333-1.28l1.792-0.512c1.536-0.426667 2.986667-0.938667 4.437334-1.365334 0.512-0.170667 1.109333-0.341333 1.621333-0.512 1.962667-0.682667 3.84-1.28 5.717333-2.048V660.906667l-56.32-46.421334z', fill: '#FF9797' },
      { d: 'M968.192 693.845333l-119.466667-98.56-119.381333 98.56-22.186667-26.88 141.568-116.906666 141.653334 116.906666z', fill: '#05A336' },
      { d: 'M848.725333 550.058667v45.226666l119.466667 98.56 22.186667-26.88z', fill: '#05A336' },
      { d: 'M808.448 729.6v117.504c12.117333 1.536 25.088 2.389333 38.656 2.389333 9.216 0 18.261333-0.426667 26.88-1.109333V730.453333c-9.301333 1.024-19.114667 1.621333-29.354667 1.621334-12.8 0-24.917333-0.853333-36.181333-2.474667z', fill: '#FFF1B8' },
      { d: 'M853.333333 849.493333c7.082667-0.170667 13.994667-0.512 20.650667-1.109333V730.453333c-6.656 0.768-13.568 1.194667-20.650667 1.450667v117.589333z', fill: '#FCE665' },
      { d: 'M806.997333 367.786667L802.133333 395.434667l25.429334-13.056 25.429333 13.056-4.864-27.648 20.736-19.712-28.672-4.096-12.629333-25.002667-12.629334 25.002667-28.672 4.096 20.736 19.712z', fill: '#FFBC00' },
      { d: 'M806.997333 367.786667L802.133333 395.434667l25.429334-13.056v-63.488l-12.714667 25.002666-28.586667 4.096z', fill: '#E59200' },
      { d: 'M940.885333 291.584l-28.757333 25.514667 38.314667 7.594666 16.128 35.584 18.261333-33.792 39.082667-3.498666-27.306667-28.757334 7.68-37.546666-34.816 16.042666-34.218667-19.968 5.632 38.826667z', fill: '#FCE665' },
      { d: 'M940.885333 291.584l-28.757333 25.514667 38.314667 7.68 53.930666-68.096-34.816 16.128-34.133333-20.053334z', fill: '#FFBC00' },
      { d: 'M823.04 404.565333h8.96v109.653334h-8.96z', fill: '#7CE597' },
      { d: 'M753.749333 225.536m-16.64 0a16.64 16.64 0 1 0 33.28 0 16.64 16.64 0 1 0-33.28 0Z', fill: '#05A336' },
      { d: 'M863.402667 514.218667l13.482666-0.426667c-3.754667-117.333333 68.010667-168.192 68.693334-168.704l-0.682667 0.341333-5.461333-12.288c-0.768 0.341333-80.042667 53.504-76.032 181.077334z', fill: '#7CE597' },
      { d: 'M923.477333 435.029333m-11.349333 0a11.349333 11.349333 0 1 0 22.698667 0 11.349333 11.349333 0 1 0-22.698667 0Z', fill: '#05A336' },
      { d: 'M512 122.538667L348.842667 285.610667v234.581333c0 22.186667 73.045333 40.192 163.157333 40.192s163.157333-18.005333 163.157333-40.192V285.610667L512 122.538667z', fill: '#FF9797' },
      { d: 'M382.378667 544.597333V252.16l-33.536 33.536v234.581333c0 9.130667 12.544 17.578667 33.536 24.32z', fill: '#FFBCC5' },
      { d: 'M602.88 213.418667v340.138666c43.605333-7.253333 72.277333-19.456 72.277333-33.365333V285.610667l-72.277333-72.192z', fill: '#FF7166' },
      { d: 'M692.821333 327.082667L512 146.261333 331.178667 327.082667l-23.722667-23.722667L512 98.816l204.544 204.544z', fill: '#05A336' },
      { d: 'M512 98.816v47.445333l180.821333 180.821334 23.722667-23.722667z', fill: '#05A336' },
      { d: 'M516.778667 305.578667c-17.92 0-34.986667-0.853333-50.688-2.389334V428.373333c15.701333 1.536 32.768 2.389333 50.688 2.389334 14.336 0 28.16-0.512 41.130666-1.536V304.128c-12.970667 0.938667-26.794667 1.450667-41.130666 1.450667z', fill: '#FFF1B8' },
      { d: 'M528.981333 305.493333v125.098667c9.984-0.256 19.712-0.682667 28.928-1.365333V304.128c-9.301333 0.682667-18.944 1.109333-28.928 1.365333z', fill: '#FCE665' },
      { d: 'M512 371.712l-229.802667 166.4v330.496c0 31.232 102.912 56.576 229.802667 56.576s229.802667-25.344 229.802667-56.576V538.112L512 371.712z', fill: '#FF9797' },
      { d: 'M282.709333 872.192l0.512 1.792c0.170667 0.341333 0.256 0.682667 0.426667 1.024 0.256 0.512 0.512 1.109333 0.853333 1.621333 0.170667 0.341333 0.426667 0.682667 0.597334 1.024 0.341333 0.512 0.768 1.109333 1.194666 1.621334l0.768 1.024c0.597333 0.768 1.28 1.450667 2.048 2.218666 0.426667 0.426667 0.938667 0.853333 1.365334 1.28 0.512 0.426667 1.024 0.938667 1.621333 1.365334 0.512 0.426667 1.109333 0.853333 1.706667 1.28 0.512 0.341333 1.024 0.768 1.536 1.109333 0.682667 0.426667 1.28 0.938667 2.048 1.365333 0.512 0.341333 1.024 0.597333 1.536 0.938667 0.768 0.512 1.536 0.938667 2.389333 1.450667 0.426667 0.256 0.853333 0.512 1.28 0.682666 3.328 1.792 6.997333 3.584 11.008 5.290667a2.56 2.56 0 0 1 0.682667 0.341333c1.28 0.512 2.645333 1.109333 4.010666 1.621334 0.426667 0.170667 0.768 0.341333 1.194667 0.426666 1.365333 0.512 2.816 1.024 4.181333 1.536 0.341333 0.170667 0.768 0.256 1.109334 0.426667 1.536 0.512 3.072 1.024 4.693333 1.621333V503.978667l-47.189333 34.218666v330.496c0 0.938667 0.085333 1.792 0.256 2.645334 0 0.256 0.085333 0.512 0.170666 0.853333z', fill: '#FFBCC5' },
      { d: 'M741.802667 538.112L640 464.384v451.157333c0.597333-0.085333 1.28-0.256 1.877333-0.341333 2.048-0.341333 4.096-0.682667 6.058667-1.024 0.853333-0.170667 1.621333-0.256 2.474667-0.426667 2.304-0.426667 4.608-0.853333 6.912-1.365333 0.768-0.170667 1.536-0.341333 2.304-0.426667 1.877333-0.426667 3.669333-0.768 5.546666-1.194666 0.597333-0.170667 1.28-0.256 1.877334-0.426667 2.218667-0.512 4.352-1.024 6.4-1.536l2.133333-0.512c2.048-0.512 4.096-1.024 6.144-1.621333 0.426667-0.085333 0.853333-0.256 1.365333-0.341334 1.706667-0.512 3.498667-0.938667 5.12-1.450666 0.597333-0.170667 1.194667-0.341333 1.877334-0.512 1.877333-0.597333 3.754667-1.194667 5.546666-1.706667l1.536-0.512c1.536-0.512 3.072-1.024 4.522667-1.536 0.426667-0.170667 0.853333-0.256 1.28-0.426667 1.706667-0.597333 3.328-1.28 4.949333-1.877333 0.512-0.170667 0.938667-0.341333 1.365334-0.597333 1.621333-0.682667 3.157333-1.365333 4.693333-2.048 0.170667-0.085333 0.341333-0.170667 0.597333-0.256 1.365333-0.597333 2.730667-1.28 4.010667-1.877334 0.341333-0.170667 0.768-0.341333 1.109333-0.512 1.365333-0.682667 2.645333-1.365333 3.925334-2.133333l0.768-0.512c1.109333-0.682667 2.133333-1.28 3.157333-1.962667 0.256-0.170667 0.426667-0.256 0.682667-0.426666 1.109333-0.768 2.133333-1.536 3.072-2.218667a2.304 2.304 0 0 0 0.682666-0.597333c0.938667-0.768 1.877333-1.536 2.730667-2.389334l0.085333-0.085333c0.768-0.768 1.536-1.536 2.218667-2.304 0.170667-0.170667 0.341333-0.341333 0.426667-0.512 0.682667-0.768 1.28-1.621333 1.792-2.389333 0.085333-0.170667 0.170667-0.256 0.256-0.426667 0.426667-0.768 0.853333-1.536 1.194666-2.218667 0.085333-0.170667 0.170667-0.256 0.170667-0.426666 0.341333-0.853333 0.597333-1.621333 0.768-2.474667 0-0.170667 0.085333-0.341333 0.085333-0.597333 0.170667-0.853333 0.256-1.706667 0.256-2.56l-0.170666-330.666667z', fill: '#FF7166' },
      { d: 'M763.904 577.621333L512 395.264 260.096 577.621333l-22.357333-30.805333L512 348.245333l274.261333 198.570667z', fill: '#05A336' },
      { d: 'M512 348.245333v47.018667l251.904 182.357333 22.357333-30.805333z', fill: '#05A336' },
      { d: 'M512 717.994667c-29.610667 0-57.941333-1.365333-83.968-3.925334v207.189334c26.026667 2.474667 54.272 3.925333 83.968 3.925333 23.722667 0 46.592-0.853333 68.096-2.56V715.52c-21.504 1.621333-44.373333 2.474667-68.096 2.474667z', fill: '#FFF1B8' },
      { d: 'M428.032 921.344c26.026667 2.474667 54.272 3.925333 83.968 3.925333', fill: '#82AAFF' },
      { d: 'M532.138667 717.824v207.189333c16.554667-0.341333 32.597333-1.109333 47.957333-2.304V715.52c-15.36 1.109333-31.402667 1.877333-47.957333 2.304z', fill: '#FCE665' },
      { d: 'M512 568.576m-55.296 0a55.296 55.296 0 1 0 110.592 0 55.296 55.296 0 1 0-110.592 0Z', fill: '#FFBC00' },
      { d: 'M547.84 526.592a55.278933 55.278933 0 0 1-48.469333 81.92c-13.653333 0-26.197333-5.034667-35.84-13.226667a55.236267 55.236267 0 0 0 103.68-26.624c0.085333-16.981333-7.509333-32-19.370667-42.069333z', fill: '#E59200' },
      { d: 'M492.458667 546.133333m-24.917334 0a24.917333 24.917333 0 1 0 49.834667 0 24.917333 24.917333 0 1 0-49.834667 0Z', fill: '#FCE665' }
    ]
  },
  {
    name: '博客',
    path: '/blog',
    isDropdown: false,
    viewBox: '0 0 1024 1024',
    paths: [
      { d: 'M394.7 461.2c62.2 22.9 136.7-22.2 165.4-100.3l67-181.9c28.8-78.1-8.7-111.7-83.2-74.7L500.4 126c-74.5 37-154.3 118.2-177.2 180.5-22.9 62.1 9.2 131.8 71.5 154.7z m66.5 168.1c22.9-62.2-22.2-136.7-100.3-165.4l-181.9-67c-78.1-28.8-111.7 8.7-74.7 83.2l21.6 43.5c37 74.5 118.2 154.3 180.5 177.2 62.2 22.9 131.9-9.2 154.8-71.5z m458.4-85.4L898 500.4c-37-74.5-118.2-154.3-180.4-177.2-62.2-22.9-131.9 9.2-154.8 71.5-22.9 62.2 22.2 136.7 100.3 165.4l181.9 67c78.1 28.8 111.7-8.7 74.6-83.2z m-290.3 18.9c-62.2-22.9-136.7 22.2-165.4 100.3l-67 181.9c-28.8 78.1 8.7 111.7 83.2 74.7l43.5-21.6c74.5-37 154.3-118.2 177.2-180.5 22.9-62.2-9.2-131.9-71.5-154.8z', fill: '#1296db' }
    ]
  },
  {
    name: '游记',
    path: '/travel',
    isDropdown: false,
    viewBox: '0 0 1024 1024',
    paths: [
      { d: 'M521.152 511.936m-416 0a416 416 0 1 0 832 0 416 416 0 1 0-832 0Z', fill: '#AEECFF' },
      { d: 'M904.576 673.472a239.424 239.424 0 0 0-286.4 234.688c0 2.688 0.704 5.12 0.768 7.744a416.576 416.576 0 0 0 285.632-242.432z', fill: '#96C1CC' },
      { d: 'M238.656 389.44c13.376-17.408 30.4-45.504 30.4-62.4a46.464 46.464 0 1 0-92.928 0c0 16.896 17.536 44.992 30.912 62.4 0 0 3.008 2.944 3.008 7.04 0 4.224-0.32 7.04-0.32 7.04h26.432s-0.576-5.312-0.32-7.04c0.832-4.864 2.816-7.04 2.816-7.04z', fill: '#CAF5FF' },
      { d: 'M208.768 399.04h28.224v6.144h-28.224z', fill: '#3F6675' },
      { d: 'M238.912 442.944a3.136 3.136 0 0 1-3.072 3.072h-24.96a3.136 3.136 0 0 1-3.072-3.072v-17.536c0-1.664 1.408-3.072 3.072-3.072h24.896c1.664 0 3.072 1.408 3.072v17.536z', fill: '#1F83AA' },
      { d: 'M221.824 405.184h1.536v17.152h-1.536zM212.672 422.336h-1.536l4.16-17.152h1.536zM235.008 422.336h-1.6l-4.096-17.152h1.536z', fill: '#3F6675' },
      { d: 'M587.008 922.304c-27.776-101.568-119.68-176.64-230.016-176.64a237.44 237.44 0 0 0-141.824 47.424 413.888 413.888 0 0 0 305.92 134.912c22.464 0 44.352-2.24 65.92-5.696z', fill: '#D4F7FF' },
      { d: 'M429.76 672.576c32.512-42.112 73.792-110.4 73.792-151.168a112.64 112.64 0 0 0-225.344 0c0 40.832 42.496 109.056 75.008 151.168 0 0 7.296 7.04 7.296 17.088 0 10.432-0.768 17.152-0.768 17.152h64.064s-1.408-12.864-0.704-17.152c1.984-11.712 6.656-17.088 6.656-17.088z', fill: '#6ED850' },
      { d: 'M389.056 706.752V408.832c-33.344 0.96-60.288 50.944-60.288 112.512 0 40.832 23.104 109.056 40.832 151.168 0 0 3.968 7.04 3.968 17.088 0 10.432-0.384 17.152-0.384 17.152h15.872z', fill: '#6BED69' },
      { d: 'M410.688 672.576c18.112-42.112 41.152-110.4 41.152-151.232 0-62.208-28.096-112.64-62.72-112.64v298.048h18.368s-0.768-12.864-0.384-17.152c0.96-11.648 3.584-17.024 3.584-17.024z', fill: '#63C451' },
      { d: 'M357.376 695.808h68.48v14.912h-68.48z', fill: '#393939' },
      { d: 'M430.464 802.24a7.552 7.552 0 0 1-7.552 7.488h-60.288a7.552 7.552 0 0 1-7.552-7.488v-42.496c0-4.096 3.392-7.488 7.552-7.488h60.288c4.16 0 7.552 3.392 7.552 7.488v42.496z', fill: '#8C5300' },
      { d: 'M389.056 710.72h3.776v41.472h-3.776zM366.912 752.256h-3.776l10.048-41.536h3.776zM420.992 752.256h-3.776l-9.984-41.536h3.776z', fill: '#393939' },
      { d: 'M820.096 800.832a238.848 238.848 0 0 0-223.744-156.288 239.424 239.424 0 0 0-239.424 239.424c0 3.712 0.96 7.104 1.088 10.816a414.72 414.72 0 0 0 462.08-93.952z', fill: '#FFFFFF' },
      { d: 'M789.184 569.216c76.608-58.368 180.928-158.272 200.064-229.632a203.968 203.968 0 0 0-393.856-105.856c-19.2 71.36 23.04 210.624 60.032 299.52 0 0 9.408 15.808 4.736 33.344-4.864 18.176-9.28 29.504-9.28 29.504l112 30.144s3.52-23.232 6.784-30.272c8.704-19.584 19.52-26.752 19.52-26.752z', fill: '#F7DA52' },
      { d: 'M701.952 609.856l139.968-520.832c-58.752-13.952-129.344 60.736-158.272 168.384-19.2 71.36-10.88 201.536 0.256 283.52 0 0 3.776 14.208-1.024 31.808a552.256 552.256 0 0 1-8.704 29.632l27.776 7.488z', fill: '#E1BA15' },
      { d: 'M755.776 560.192c51.52-65.152 123.84-173.568 142.976-244.928 29.312-108.8 3.84-210.176-56.832-226.432l-140.032 521.024 32.192 8.64s4.672-22.848 7.168-30.144c7.424-20.032 14.528-28.16 14.528-28.16z', fill: '#E39F1A' },
      { d: 'M651.712 575.872l119.808 32.256-6.976 25.792-119.808-32.256z', fill: '#393939' },
      { d: 'M729.472 796.224a13.632 13.632 0 0 1-16.704 9.6l-105.472-28.352a13.696 13.696 0 0 1-9.6-16.64l20.032-74.368a13.504 13.504 0 0 1 16.64-9.6l105.536 28.352a13.44 13.44 0 0 1 9.536 16.64l-19.968 74.368z', fill: '#8C5300' },
      { d: 'M700.096 616.768l6.464 1.728-19.52 72.512-6.464-1.792zM641.92 678.848l-6.592-1.728 37.056-67.84 6.4 1.728zM736.448 704.256l-6.656-1.6 2.112-77.376 6.592 1.728z', fill: '#393939' }
    ]
  },
  {
    name: '记录',
    path: '/records',
    isDropdown: true,
    viewBox: '0 0 1024 1024',
    paths: [
      { d: 'M1024 0v1024H0V0z', fill: '#F5F5F5' },
      { d: 'M723.263043 716.912076c116.55892 67.245531 116.55892 176.706312 0 243.951842a466.982853 466.982853 0 0 1-422.526086 0c-116.55892-67.245531-116.55892-176.706312 0-243.951842a466.982853 466.982853 0 0 1 422.526086 0z', fill: '#080A0D' },
      { d: 'M709.813937 725.878147c108.340022 62.388909 108.340022 164.004378 0 226.393287a433.360088 433.360088 0 0 1-392.265597 0c-108.340022-62.388909-108.340022-164.004378 0-226.393287a433.360088 433.360088 0 0 1 392.265597 0z', fill: '#0B0E14' },
      { d: 'M693.002554 734.470631c100.121124 57.905874 100.121124 151.302444 0 209.208318a400.110908 400.110908 0 0 1-362.005108 0c-100.121124-57.905874-100.121124-151.302444 0-209.208318a399.737322 399.737322 0 0 1 362.005108 0z', fill: '#0F131B' },
      { d: 'M677.685516 743.436702c91.528639 53.049252 91.528639 138.600511 0 191.649763a366.488143 366.488143 0 0 1-331.744619 0c-91.528639-53.049252-91.528639-138.600511 0-191.649763a366.488143 366.488143 0 0 1 331.744619 0z', fill: '#131822' },
      { d: 'M662.742065 752.029186c83.309741 48.19263 83.309741 125.898577 0 174.091208a332.865378 332.865378 0 0 1-301.110544 0c-83.309741-48.19263-83.309741-125.898577 0-174.091208a332.865378 332.865378 0 0 1 301.110544 0z', fill: '#171D29' },
      { d: 'M647.425027 760.995257c74.717256 43.336009 74.717256 112.075885 0 156.532653a298.869026 298.869026 0 0 1-270.850054 0c-74.717256-43.336009-74.717256-112.075885 0-156.532653a298.869026 298.869026 0 0 1 270.850054 0z', fill: '#1B2230' },
      { d: 'M632.481576 769.587742c66.498358 37.358628 66.498358 100.49471 0 138.974097a265.619847 265.619847 0 0 1-240.589566 0c-66.498358-37.358628-66.498358-100.49471 0-138.974097a265.619847 265.619847 0 0 1 240.589566 0z', fill: '#1F2737' },
      { d: 'M617.164538 778.553812c57.905874 33.622765 57.905874 87.792776 0 121.415542a231.997081 231.997081 0 0 1-210.329076 0c-57.905874-33.622765-57.905874-87.792776 0-121.415542a232.370668 232.370668 0 0 1 210.329076 0z', fill: '#232C3F' },
      { d: 'M601.847501 787.146297c49.686976 28.766144 49.686976 74.717256 0 103.856986a198.747902 198.747902 0 0 1-179.695002 0c-49.686976-28.766144-49.686976-74.717256 0-103.856986a198.747902 198.747902 0 0 1 179.695002 0z', fill: '#273246' },
      { d: 'M586.90405 796.112368a45.577526 45.577526 0 0 1 0 86.298431 165.125137 165.125137 0 0 1-149.434513 0 45.577526 45.577526 0 0 1 0-86.298431 165.125137 165.125137 0 0 1 149.434513 0z', fill: '#2B374D' },
      { d: 'M571.587012 804.704852a37.358628 37.358628 0 0 1 0 68.739876 131.502371 131.502371 0 0 1-119.174024 0 37.358628 37.358628 0 0 1 0-68.739876 131.502371 131.502371 0 0 1 119.174024 0z', fill: '#2F3C54' },
      { d: 'M556.269974 813.670923a26.898212 26.898212 0 0 1 0 51.181321 97.879606 97.879606 0 0 1-88.913535 0 26.898212 26.898212 0 0 1 0-51.181321 97.879606 97.879606 0 0 1 88.913535 0z', fill: '#34415C' },
      { d: 'M541.326523 821.889821a17.932142 17.932142 0 0 1 0 33.622766 64.630427 64.630427 0 0 1-58.27946 0 17.932142 17.932142 0 0 1 0 0-33.622766 64.630427 64.630427 0 0 1 58.27946 0z', fill: '#384763' },
      { d: 'M263.751915 444.19409v-14.569865l2.241518-4.483036 2.98869-4.483035 3.362277-4.109449 3.735863-3.362277 3.735863-2.615104 424.767603-243.204669h8.592484l10.08683 5.97738h-8.592485L293.265232 416.548705l-3.735863 2.615104-3.735863 3.362276-3.362277 4.109449-2.98869 4.483036-2.241517 4.483035v346.314484l2.241517 1.867931-10.086829-5.97738-2.241518-1.867931v-10.08683q-3.362277-159.894929-3.362277-321.657789z', fill: '#C93E3E' },
      { d: 'M293.265232 416.548705l421.405326-243.578256c10.460416-5.977381 19.426487 0 19.426487 11.207588v323.899307a42.588836 42.588836 0 0 1-19.426487 33.249179l-324.646479 186.793141L293.265232 784.531193c-10.460416 5.977381-19.426487 0-19.426487-11.207588V448.303539a42.588836 42.588836 0 0 1 19.426487-31.754834z', fill: '#F2513F' },
      { d: 'M718.406421 545.062386l-410.944911 236.480117c-10.460416 5.977381-18.679314 0-18.679314-10.834002v-314.55965a41.468077 41.468077 0 0 1 18.679314-32.502007l410.944911-236.853703c10.460416-5.977381 18.679314 0 18.679314 10.834002v314.933236a41.468077 41.468077 0 0 1-18.679314 32.502007z', fill: '#E6EAEB' },
      { d: 'M280.563298 450.545057v-13.822693l2.241518-4.483035 2.615104-4.109449 2.98869-3.735863 3.362277-3.362277 3.735862-2.615104 205.098869-116.55892L709.813937 181.93652h8.218898l9.713243 5.603794h-8.218898l-213.691354 123.283473-195.759212 112.075885-3.735862 2.615104-3.362277 3.362276-3.362277 3.735863-2.615104 4.109449-2.241517 4.483035v338.469172l2.241517 1.867932-9.713243-5.603794-2.241518-1.867932v-10.08683q-4.856622-156.159066-4.483035-313.43889z', fill: '#BDC3C7' },
      { d: 'M518.164174 304.846406l201.736592-116.55892 1.494345-0.747172 1.120759-0.747173 1.494345-0.373586 1.494345-0.373586h1.120759l1.494345-0.373587h1.120759l1.120759 0.373587h0.747173l1.494345 0.747172 9.713243 5.603794-1.494345-0.373586-0.373586-0.373586h-5.230208l-1.494345 0.373586-1.120759 0.747173-1.494345 0.373586-1.494346 0.747173-201.736592 116.55892-9.713243-5.603795z', fill: '#BDC3C7' },
      { d: 'M729.614009 551.413353L635.09668 605.583364l-107.219263 62.015323V310.450201L635.09668 248.434878l94.143743-54.543597c10.460416-5.977381 18.679314 0 18.679314 10.834002v315.680408a41.468077 41.468077 0 0 1-18.305728 31.007662zM511.813207 665.730755V308.208683l6.350967-3.362277v357.148486l-6.350967 3.735863z', fill: '#E6EAEB' },
      { d: 'M527.877417 667.598687V310.450201l-9.713243-5.603795v357.148486l9.713243 5.603795z', fill: '#A6AEB3' },
      { d: 'M291.770887 457.26961v-13.822693l7.098139-4.856621v-4.10945l3.362276-3.735862 3.362277-3.362277 3.735863-2.615104 202.483765-116.55892 11.207588 5.603794-202.857351 116.55892-3.735863 2.615104-3.362276 3.362277-3.362277 3.735863-2.615104 4.109449-2.615104 4.109449V786.399124l2.241518 1.867932L298.869026 784.531193l-2.241518-1.867931v-10.08683q-4.856622-158.400584-4.856621-315.306822z', fill: '#BDC3C7' },
      { d: 'M320.163444 430.371397l94.143743-54.543597 101.615469-58.653046 7.098139-3.362277v356.401314l-5.603794 4.109449-101.615469 58.653046-95.638088 54.917184c-10.460416 5.977381-18.679314 0-18.679314-10.834003v-314.186063a41.468077 41.468077 0 0 1 18.679314-32.502007zM539.085005 672.455308l204.351697-118.053265a37.358628 37.358628 0 0 0 16.437796-28.766144V288.782196l-60.147391-44.830354-27.271799-6.350966-32.502006 10.460415-100.868297 62.015323z', fill: '#E6EAEB' },
      { d: 'M722.142284 333.986136l30.634075-17.558555c14.943451-8.218898 23.535936-15.317038 8.218898-27.271798L696.36483 239.095221l25.777454 37.358628z', fill: '#F5F9FA' },
      { d: 'M529.371762 311.197373l117.679679-68.366289a45.20394 45.20394 0 0 1 50.060562-4.483036c17.184969 8.218898 21.294418 19.0529 25.030281 39.600146v56.037942l-8.218898-4.856621V280.189712a37.358628 37.358628 0 0 0-52.675666-33.996352l-29.513316 15.317038-92.649399 55.290769z', fill: '#BDC3C7' },
      { d: 'M539.085005 673.949653V316.801167l-9.713243-5.603794v357.148486l9.713243 5.603794z', fill: '#A6AEB3' },
      { d: 'M302.604889 463.620576v-13.822692l2.241517-4.483035 2.615104-4.10945 3.362277-3.735862 3.362276-3.362277 3.735863-2.615104L523.020795 314.55965l9.713244 5.603794-201.736593 116.55892-3.735863 2.615104-3.362276 3.362277-3.362277 3.735862-2.615104 4.10945-2.241517 4.483035v338.469172l2.241517 1.867931-9.713243-5.603794-2.241518-1.867931v-10.08683q-3.362277-157.279825-3.362276-314.186064z', fill: '#BDC3C7' },
      { d: 'M330.997446 436.722364l94.143743-54.543597 101.615469-58.653046 5.603794-3.362277v356.401313l-5.603794 4.109449-101.241882 59.026633-94.51733 54.543597c-10.460416 5.977381-18.679314 0-18.679314-10.834002v-314.186063a41.468077 41.468077 0 0 1 18.679314-32.502007z', fill: '#E6EAEB' },
      { d: 'M571.587012 372.465524l142.336374-82.188983v7.09814l-142.336374 82.188982v-7.098139zM571.587012 411.318497l135.611821-78.079533v7.098139l-135.611821 78.45312v-7.471726zM571.587012 452.786574l113.57023-65.377599v7.098139l-113.57023 65.3776v-7.09814zM571.587012 491.639548l161.015688-92.649398v7.098139l-161.015688 93.022984v-7.471725zM571.587012 530.866107l145.325064-84.056913v7.471725L571.587012 537.964247v-7.09814zM571.587012 572.334185l130.755199-75.464429v7.098139l-130.755199 75.464429v-7.098139z', fill: '#3E566E' },
      { d: 'M355.654141 618.285297l140.468442-81.068223v7.471726l-140.468442 81.068223v-7.471726zM355.654141 657.885443l142.70996-82.188982v7.09814l-142.70996 82.562568v-7.471726zM355.654141 700.100693l128.887267-74.34367v7.471726l-128.887267 74.34367v-7.471726zM454.280919 479.684787l34.743525-20.17366v7.471726l-34.743525 20.173659v-7.471725zM454.280919 521.900036l39.600146-22.788763v7.09814l-39.600146 22.788763v-7.09814zM454.280919 440.084641l49.686976-28.766144v7.471726l-49.686976 28.766143v-7.471725z', fill: '#4A637D' },
      { d: 'M443.446917 510.692448v22.041591a5.977381 5.977381 0 0 1-2.615104 4.483035l-78.079533 45.20394h-2.615104v-41.094491c2.98869-4.109449 6.724553-5.977381 9.713244-5.230208l26.151039 7.471726a9.713243 9.713243 0 0 0 9.339657-4.856622l19.800073-25.403867c2.98869-3.735863 6.724553-5.603794 9.339657-4.856622z', fill: '#3D566E' },
      { d: 'M443.446917 510.692448l-8.592484-2.98869c-2.615104 0-6.350967 0-9.339657 4.856621l-19.800073 25.403868a9.713243 9.713243 0 0 1-9.339657 4.856621l-26.15104-7.471725c-2.615104 0-6.724553 0-9.713244 5.230208v-45.203941L443.446917 448.303539z', fill: '#6EBCC6' },
      { d: 'M419.537395 468.103612c7.471726-4.483035 13.449106 0 13.449106 7.845312a29.886903 29.886903 0 0 1-13.449106 23.535936c-7.471726 4.483035-13.449106 0-13.449106-7.845312a29.886903 29.886903 0 0 1 13.449106-23.535936z', fill: '#FFCB05' },
    ],
    children: [
      {
        name: '生活倒影',
        path: '/records/life',
        viewBox: '0 0 1024 1024',
        paths: [
          { d: 'M729.6 917.333333h-554.666667c-12.8 0-25.6-12.8-25.6-25.6s12.8-25.6 25.6-25.6h554.666667c12.8 0 25.6 12.8 25.6 25.6s-12.8 25.6-25.6 25.6zM789.333333 614.4H725.333333v-213.333333h64c59.733333 0 106.666667 46.933333 106.666667 106.666666s-46.933333 106.666667-106.666667 106.666667z m-12.8-51.2h8.533334c29.866667 0 55.466667-25.6 55.466666-55.466667 0-29.866667-25.6-55.466667-55.466666-55.466666h-8.533334v110.933333z', fill: '#6A3906' },
          { d: 'M469.333333 840.533333h-29.866666c-170.666667 0-307.2-115.2-307.2-256V345.6c0-12.8 12.8-25.6 25.6-25.6h593.066666c8.533333 0 12.8 4.266667 17.066667 8.533333 4.266667 4.266667 8.533333 12.8 8.533333 17.066667v238.933333c-4.266667 145.066667-140.8 256-307.2 256zM179.2 375.466667v209.066666c0 110.933333 115.2 204.8 256 204.8h34.133333c136.533333 0 251.733333-89.6 256-200.533333v-55.466667V426.666667 375.466667H179.2z', fill: '#6A3906' },
          { d: 'M661.333333 469.333333v-34.133333c0-12.8-8.533333-21.333333-21.333333-21.333333H260.266667c-12.8 0-21.333333 8.533333-21.333334 21.333333v145.066667c0 89.6 89.6 162.133333 200.533334 162.133333h21.333333c110.933333 0 196.266667-72.533333 200.533333-162.133333 4.266667-17.066667 0-25.6 0-110.933334z', fill: '#F5CB2B' },
          { d: 'M332.8 273.066667h-8.533333c-12.8 0-21.333333-8.533333-21.333334-21.333334V149.333333c0-8.533333 8.533333-21.333333 21.333334-21.333333h8.533333c12.8 0 21.333333 8.533333 21.333333 21.333333v98.133334c4.266667 17.066667-8.533333 25.6-21.333333 25.6zM456.533333 273.066667h-8.533333c-12.8 0-21.333333-8.533333-21.333333-21.333334V149.333333c0-8.533333 8.533333-21.333333 21.333333-21.333333h8.533333c12.8 0 21.333333 8.533333 21.333334 21.333333v98.133334c4.266667 17.066667-8.533333 25.6-21.333334 25.6zM580.266667 273.066667h-8.533334c-12.8 0-21.333333-8.533333-21.333333-21.333334V149.333333c0-12.8 8.533333-21.333333 21.333333-21.333333h8.533334c12.8 0 21.333333 8.533333 21.333333 21.333333v98.133334c0 17.066667-8.533333 25.6-21.333333 25.6z', fill: '#6A3906' }
        ]
      },
      {
        name: '视听盛宴',
        path: '/records/media',
        viewBox: '0 0 1024 1024',
        paths: [
          { d: 'M512 1024C233.813333 1024 8.533333 798.72 8.533333 520.533333c0-221.866667 148.48-419.84 361.813334-482.986666 18.773333-5.12 37.546667 5.12 42.666666 23.893333 5.12 18.773333-5.12 37.546667-23.893333 42.666667C204.8 158.72 76.8 329.386667 76.8 520.533333 76.8 761.173333 271.36 955.733333 512 955.733333 750.933333 955.733333 947.2 761.173333 947.2 520.533333c0-18.773333 15.36-34.133333 34.133333-34.133333s34.133333 15.36 34.133334 34.133333C1013.76 798.72 788.48 1024 512 1024z', fill: '#1afa29' },
          { d: 'M508.245333 804.864c-128 0-232.106667-104.106667-232.106666-232.106667s104.106667-232.106667 232.106666-232.106666 232.106667 104.106667 232.106667 232.106666-104.106667 232.106667-232.106667 232.106667z m0-395.946667c-90.453333 0-163.84 73.386667-163.84 163.84s73.386667 163.84 163.84 163.84 163.84-73.386667 163.84-163.84-73.386667-163.84-163.84-163.84z', fill: '#1afa29' },
          { d: 'M706.218667 620.544c-18.773333 0-34.133333-15.36-34.133334-34.133333V35.157333c0-11.946667 6.826667-23.893333 17.066667-30.72 10.24-5.12 23.893333-5.12 34.133333 1.706667l238.933334 155.306667c15.36 10.24 20.48 30.72 10.24 47.786666-10.24 15.36-30.72 20.48-47.786667 10.24l-184.32-121.173333v488.106667c0 18.773333-15.36 34.133333-34.133333 34.133333z', fill: '#1afa29' }
        ]
      },
      {
        name: '学习人生',
        path: '/records/study',
        viewBox: '0 0 1024 1024',
        paths: [
          { d: 'M249.709714 615.424a146.285714 146.285714 0 1 1 29.915429-43.227429l172.178286 172.178286c10.752-4.900571 22.235429-8.484571 34.230857-10.678857V290.377143a146.285714 146.285714 0 1 1 146.066285-60.489143l162.084572 162.084571a146.285714 146.285714 0 1 1-36.571429 36.571429L595.529143 266.386286a145.554286 145.554286 0 0 1-57.782857 23.917714v443.392a146.285714 146.285714 0 1 1-129.170286 40.594286L249.709714 615.424zM512 219.428571a73.142857 73.142857 0 1 0 0-146.285714 73.142857 73.142857 0 0 0 0 146.285714z m365.714286 365.714286a73.142857 73.142857 0 1 0 0-146.285714 73.142857 73.142857 0 0 0 0 146.285714z m-365.714286 365.714286a73.142857 73.142857 0 1 0 0-146.285714 73.142857 73.142857 0 0 0 0 146.285714zM146.285714 585.142857a73.142857 73.142857 0 1 0 0-146.285714 73.142857 73.142857 0 0 0 0 146.285714z', fill: '#9BB4C8' }
        ]
      },
      {
        name: '海外趣事',
        path: '/records/travel',
        viewBox: '0 0 1025 1024',
        paths: [
          { d: 'M512.035 907.638c-53.397 0-105.213-10.464-154.01-31.101-47.118-19.927-89.426-48.447-125.749-84.767-36.323-36.323-64.846-78.63-84.773-125.748-20.64-48.8-31.105-100.62-31.105-154.021s10.465-105.22 31.105-154.02c19.928-47.118 48.45-89.426 84.773-125.748 36.323-36.321 78.631-64.84 125.748-84.768 48.798-20.637 100.614-31.102 154.01-31.102 53.397 0 105.213 10.464 154.011 31.102 47.117 19.926 89.425 48.447 125.748 84.768 36.324 36.322 64.846 78.63 84.774 125.747 20.64 48.8 31.105 100.62 31.105 154.021s-10.466 105.22-31.105 154.02c-19.928 47.119-48.45 89.426-84.774 125.749-36.323 36.32-78.63 64.84-125.748 84.767-48.798 20.637-100.613 31.1-154.01 31.1z m0-721.456c-179.657 0-325.818 146.162-325.818 325.819S332.378 837.82 512.035 837.82c179.657 0 325.818-146.162 325.818-325.819s-146.16-325.819-325.818-325.819z', fill: '#13227a' },
          { d: 'M775.947 565.96l-23.64-65.692c68.038-24.487 123.392-52.292 160.073-80.41 33.41-25.609 43.406-45.525 41.62-55.623-3.294-18.68-52.596-49.25-174.935-56.963l4.394-69.68c63.604 4.01 115.885 14.095 155.39 29.972 61.38 24.67 79.507 59.587 83.906 84.534 3.994 22.607-1.213 45.664-15.48 68.521-11.488 18.407-29.125 36.793-52.419 54.65-42.32 32.44-104.185 63.8-178.909 90.691zM302.45 648.768c-72.724 0-136.28-7.2-185.314-21.094-30.645-8.683-55.657-20.031-74.338-33.727-23.316-17.094-37.273-37.862-41.482-61.724-10.673-60.426 43.745-121.44 157.374-176.44l30.417 62.843c-99.8 48.307-121.503 87.49-119.036 101.461 1.858 10.534 20.283 27.432 66.098 40.414 49.619 14.059 117.92 20.275 197.522 17.992l2.007 69.789c-11.27 0.324-22.368 0.486-33.248 0.486zM684.536 531.887c-11.273 2-87.205 16.137-87.205 16.137L468.695 427.069l-29.478 3.863 63.023 135.864-65.546 10.91-71.023-44.91-12.954-0.614 40.887 83.773-11.41 92.205 12.477-4.842 49.25-64.068s228.16-42.453 251.182-46.5c24.865-4.409 33.024-14.863 29.023-37.567-3.589-20.296-18.703-26.978-39.59-23.296zM513.513 637.25l-16.205 132.41 25.205-6.024 77.364-141.658-86.364 15.272z', fill: '#F4BA1B' }
        ]
      },
      {
        name: '爱心资源',
        path: '/records/resources',
        viewBox: '0 0 1449 1024',
        paths: [
          { d: 'M1357.075237 579.532219a138.443423 138.443423 0 0 0-99.80805-217.002017 170.478588 170.478588 0 0 0 3.541576-35.415759 173.054279 173.054279 0 0 0-173.054279-173.859183 177.078797 177.078797 0 0 0-45.396564 6.278248A189.957255 189.957255 0 0 0 724.420989 92.243565a189.957255 189.957255 0 0 0-317.936932 67.289943 177.078797 177.078797 0 0 0-45.396564-6.278248 173.054279 173.054279 0 0 0-173.054279 173.054279 170.478588 170.478588 0 0 0 3.541576 35.415759A138.443423 138.443423 0 0 0 91.76674 579.532219a103.993548 103.993548 0 1 0 141.019115 56.343254 138.443423 138.443423 0 0 0 110.915719-136.833616 153.575611 153.575611 0 0 0 17.385919 0.804903 173.054279 173.054279 0 0 0 156.312283-99.325107A189.474313 189.474313 0 0 0 724.420989 352.871358a189.474313 189.474313 0 0 0 207.021212 47.167353A173.054279 173.054279 0 0 0 1087.754484 499.041857a153.575611 153.575611 0 0 0 17.385919 0 138.443423 138.443423 0 0 0 110.915719 135.706751A103.832567 103.832567 0 1 0 1357.075237 579.532219z', fill: '#86D172' },
          { d: 'M1312.805537 808.44681a136.189693 136.189693 0 0 1-136.028712-136.028713 127.013792 127.013792 0 0 1 0.965884-16.098072A170.96153 170.96153 0 0 1 1076.002891 531.238002a206.055328 206.055328 0 0 1-159.853859-92.724898A221.026535 221.026535 0 0 1 724.420989 396.658116a221.026535 221.026535 0 0 1-191.728044 41.854988A206.055328 206.055328 0 0 1 372.678105 531.238002a170.96153 170.96153 0 0 1-101.578837 125.564965 127.013792 127.013792 0 0 1 0.965884 16.098072 136.028712 136.028712 0 1 1-222.958304-104.798452 170.639568 170.639568 0 0 1 106.891201-232.134205v-9.658843A204.606501 204.606501 0 0 1 387.16637 122.829903 222.797323 222.797323 0 0 1 585.977565 0.00161 220.221631 220.221631 0 0 1 724.420989 48.295827a220.221631 220.221631 0 0 1 138.443423-48.294217A222.797323 222.797323 0 0 1 1062.48051 122.829903a204.606501 204.606501 0 0 1 230.685379 203.479636v9.658843A170.639568 170.639568 0 0 1 1400.540032 568.102587a135.867732 135.867732 0 0 1-86.929591 240.344223z', fill: '#622C47' },
          { d: 'M515.146046 347.880956m-241.471087 0a241.471087 241.471087 0 1 0 482.942174 0 241.471087 241.471087 0 1 0-482.942174 0Z', fill: '#E55555' },
          { d: 'M515.146046 621.548188a273.667232 273.667232 0 1 1 273.667232-273.667232 273.667232 273.667232 0 0 1-273.667232 273.667232z m0-482.942174a209.274942 209.274942 0 1 0 209.274943 209.274942 209.274942 209.274942 0 0 0-209.274943-209.274942z', fill: '#622C47' },
          { d: 'M724.420989 186.900231a611.726754 611.726754 0 0 1 611.726754 611.726754 193.17687 193.17687 0 0 1-193.17687 193.17687H305.871104a193.17687 193.17687 0 0 1-193.17687-193.17687 611.726754 611.726754 0 0 1 611.726755-611.726754z', fill: '#FFAB47' },
          { d: 'M1142.970873 1024H305.871104a225.373015 225.373015 0 0 1-225.373015-225.373015 643.922899 643.922899 0 0 1 1287.845799 0 225.373015 225.373015 0 0 1-225.373015 225.373015z m-418.549884-804.903624a579.530609 579.530609 0 0 0-579.53061 579.530609 160.980725 160.980725 0 0 0 160.980725 160.980725h837.099769a160.980725 160.980725 0 0 0 160.980725-160.980725 579.530609 579.530609 0 0 0-579.530609-579.530609z', fill: '#622C47' },
          { d: 'M563.440264 492.763608m-48.294218 0a48.294217 48.294217 0 1 0 96.588435 0 48.294217 48.294217 0 1 0-96.588435 0Z', fill: '#622C47' },
          { d: 'M885.401713 492.763608m-48.294217 0a48.294217 48.294217 0 1 0 96.588435 0 48.294217 48.294217 0 1 0-96.588435 0Z', fill: '#622C47' },
          { d: 'M724.420989 750.332768m-48.294218 0a48.294217 48.294217 0 1 0 96.588435 0 48.294217 48.294217 0 1 0-96.588435 0Z', fill: '#622C47' },
          { d: 'M1046.382438 750.332768m-48.294217 0a48.294217 48.294217 0 1 0 96.588434 0 48.294217 48.294217 0 1 0-96.588434 0Z', fill: '#622C47' },
          { d: 'M402.459539 750.332768m-48.294217 0a48.294217 48.294217 0 1 0 96.588434 0 48.294217 48.294217 0 1 0-96.588434 0Z', fill: '#622C47' }
        ]
      }
    ]
  },
  {
    name: '百宝箱',
    path: '/toolkit',
    isDropdown: false,
    viewBox: '0 0 1048 1024',
    paths: [
      { d: 'M728.333572 200.628432H605.948406c13.818917-16.23555 23.015546-37.093388 26.496648-61.978947 6.549841-46.366735-0.671287-80.458513-22.056565-104.241244C589.904653 11.584491 556.925293 0.00959 512.361443 0.00959c-46.990073 0-81.666829 17.645252-101.786253 50.001273C390.436588 17.654842 355.740652 0.00959 308.788938 0.00959c-44.554261 0-77.524031 11.574902-98.007866 34.398651-21.346919 23.773141-28.558457 57.874508-22.056565 104.241244 3.500281 24.885559 12.67773 45.743398 26.477467 61.978947H92.903117C57.938667 200.628432 29.476108 228.275857 29.476108 262.262146v48.649111c0 44.851545 7.038921 58.047125 42.847275 60.924068v332.766436c0 33.995879 28.452969 61.652894 63.436599 61.652893h549.707136c34.98363 0 63.436599-27.657014 63.436598-61.652893V371.912043c36.249485-2.742686 42.866454-15.545083 42.866455-61.000786v-48.649111c0-33.995879-28.462559-61.643304-63.436599-61.643304z m-337.743547-61.978947c0 58.497846-8.304776 61.969358-72.642817 61.969357-28.961229 0-64.951789-10.404945-71.923582-59.993856-4.286645-30.3997-0.52744-52.427496 11.15295-65.450459 11.191309-12.466754 31.550478-18.77685 60.502117-18.77685 31.291553 0 72.882562 8.496572 72.882562 81.877805v0.374003z m40.04705 0.402772c0.047949-72.47979 41.121109-80.870875 72.029069-80.870875 28.606406 0 48.706649 6.242967 59.763701 18.546694 11.507773 12.869526 15.247799 34.609627 11.009103 64.635325-6.933433 48.975164-42.415733 59.265031-71.041319 59.265031-63.551676 0-71.722195-3.433152-71.760554-61.202172v-0.258925-0.105488z m209.767522 521.973403L539.701993 563.123282l-103.483648 100.597115v-291.146657h204.186252z m0 0', fill: '#221714' }
    ]
  },
  {
    name: '留言',
    path: '/comments',
    isDropdown: false,
    viewBox: '0 0 1024 1024',
    paths: [
      { d: 'M950.784 510.976L226.816 888.32 24.064 496.128 746.496 122.88l150.016 290.304z', fill: '#475E70' },
      { d: 'M939.52 604.16L154.624 827.904 35.328 402.432l782.848-219.648 88.576 314.88z', fill: '#EF6062' },
      { d: 'M829.44 794.624H79.872V353.28h813.056v327.168z', fill: '#EDEDED' },
      { d: 'M79.872 353.28h813.056V467.968H79.872z', fill: '#54BFD1' },
      { d: 'M577.024 390.144h263.68v43.008h-263.68zM610.816 551.936h-473.6c-3.072 0-5.632-2.56-5.632-5.632v-20.992c0-3.072 2.56-5.632 5.632-5.632h473.6c3.072 0 5.632 2.56 5.632 5.632v20.992c-0.512 3.072-2.56 5.632-5.632 5.632zM526.336 712.704h-389.632c-3.072 0-5.632-2.56-5.632-5.632V686.08c0-3.072 2.56-5.632 5.632-5.632h389.632c3.072 0 5.632 2.56 5.632 5.632v20.992c0 3.072-2.56 5.632-5.632 5.632zM698.368 632.32H136.704c-3.072 0-5.632-2.56-5.632-5.632v-20.992c0-3.072 2.56-5.632 5.632-5.632h561.664c3.072 0 5.632 2.56 5.632 5.632v20.992c0 3.072-2.56 5.632-5.632 5.632zM829.44 794.624l-27.648-74.752 91.136-39.424z', fill: '#4B5C70' },
      { d: 'M746.496 655.36l179.712-443.904c5.12-13.312 22.016-18.944 36.352-13.312 14.848 6.144 22.528 21.504 17.408 34.816l-179.712 443.904-53.76-21.504z', fill: '#E6D770' },
      { d: 'M800.256 677.376L746.496 655.36l7.168 60.416z', fill: '#4B5C70' },
      { d: 'M939.904 239.8464l11.392 4.61824-171.97056 424.17664-11.38688-4.61824z', fill: '#F98762' },
      { d: 'M906.24 262.144l20.48-50.176c5.12-13.312 22.016-18.944 36.352-13.312 14.848 6.144 22.528 21.504 17.408 34.816l-20.48 50.176-53.76-21.504z', fill: '#F98762' },
      { d: 'M985.088 281.6l-29.184-11.776c-1.536-0.512-2.048-2.56-1.536-4.096l4.608-10.752c0.512-1.536 2.56-2.048 4.096-1.536l29.184 11.776c1.536 0.512 2.048 2.56 1.536 4.096l-4.608 10.752c-1.024 1.024-2.56 2.048-4.096 1.536z', fill: '#F98762' },
      { d: 'M976.896 262.144l-51.2 126.464c-0.512 1.536 0 3.584 1.536 4.096l10.752 4.608c1.536 0.512 3.584 0 4.096-1.536l51.2-126.464c0.512-1.536 0-3.584-1.536-4.096l-10.752-4.608c-1.536-0.512-3.584 0-4.096 1.536z', fill: '#F98762' }
    ]
  },
  {
    name: '联系我',
    path: '/contact',
    isDropdown: false,
    viewBox: '0 0 1024 1024',
    paths: [
      { d: 'M627.6 160.9c-67.5 0-127.1 33.8-160.8 86.8-33.8-53.1-93.3-86.8-160.8-86.8-106.1 0-193 86.8-193 193 0 191.4 353.8 386 353.8 386s353.8-193 353.8-386c-0.1-106.2-86.9-193-193-193z', fill: '#F98AAF' },
      { d: 'M835.8 719H685.1l-75.3 66.2V553.5c0-36.4 33.9-66.2 75.3-66.2h150.6c41.4 0 75.3 29.8 75.3 66.2v99.3c0.1 36.4-33.8 66.2-75.2 66.2z', fill: '#1B85CC' },
      { d: 'M744.3 790.4H598.9l-72.7 72.7V608.7c0-40 32.7-72.7 72.7-72.7h145.4c40 0 72.7 32.7 72.7 72.7v109c0 40-32.7 72.7-72.7 72.7z', fill: '#2196F3' },
      { d: 'M628.3 667.6c0 9.4-7.6 17-17 17s-17-7.6-17-17 7.6-17 17-17 17 7.6 17 17z m60.3-17.1c-9.4 0-17 7.6-17 17s7.6 17 17 17 17-7.6 17-17c0.1-9.3-7.6-17-17-17z m76.4 0c-9.4 0-17 7.6-17 17s7.6 17 17 17 17-7.6 17-17c0-9.3-7.6-17-17-17z', fill: '#FFFFFF' }
    ]
  },
]

// 登陆图标
const loginIcon = {
  viewBox: '0 0 800 800',
  gTransform: 'translate(145.809836,664.279006) scale(0.063357,-0.063357)',
  paths: [
    { d: 'M2524 5775 c-84 -42 -130 -140 -103 -222 39 -123 345 -632 511 -852 26 -35 48 -68 48 -72 0 -5 -315 -9 -700 -9 -385 0 -700 3 -700 6 0 4 24 37 53 73 177 219 403 610 422 727 15 93 -39 188 -129 230 l-51 24 -544 0 -545 0 -33 -22 c-86 -59 -69 -180 30 -217 18 -7 171 -11 433 -11 222 0 404 -2 404 -4 0 -22 -160 -282 -242 -393 -51 -70 -47 -71 -98 22 -50 91 -77 123 -123 147 -128 67 -283 -16 -295 -157 -4 -49 0 -63 41 -142 24 -49 69 -131 99 -183 l55 -95 -41 -47 c-88 -102 -106 -135 -106 -197 0 -103 68 -172 176 -179 84 -6 132 18 220 108 l68 70 905 0 904 0 71 -73 c86 -89 137 -113 221 -104 69 7 118 37 150 91 33 57 34 126 2 187 l-24 44 110 223 c99 201 110 228 110 277 0 173 -217 261 -344 139 -15 -14 -55 -86 -90 -160 -34 -74 -66 -133 -70 -132 -10 4 -109 140 -109 150 0 4 39 90 86 190 125 265 126 268 127 326 0 142 -153 234 -289 173 -54 -25 -87 -68 -139 -180 -23 -50 -44 -94 -47 -96 -2 -3 -39 57 -81 133 -87 157 -109 185 -169 212 -59 27 -114 25 -174 -5z', fill: 'currentColor' },
    { d: 'M4376 5691 c-16 -11 -35 -30 -42 -43 -30 -53 -6 -135 48 -164 18 -11 252 -13 1148 -14 872 0 1130 -3 1149 -13 53 -27 60 -51 62 -202 l2 -140 -1117 -5 -1118 -5 -29 -33 c-33 -37 -39 -94 -14 -142 33 -63 -34 -60 1175 -60 l1100 0 0 -155 0 -155 -1232 -1 c-928 0 -1242 -3 -1268 -12 -67 -23 -99 -111 -65 -177 32 -62 12 -60 710 -60 l635 0 0 -728 c0 -642 -2 -730 -16 -750 -14 -21 -22 -22 -156 -22 l-140 0 -39 -39 c-32 -32 -39 -46 -39 -77 0 -51 18 -83 60 -112 35 -23 37 -23 280 -20 l245 3 57 28 c68 33 117 87 141 154 16 44 17 112 17 806 l0 757 659 0 659 0 30 25 c43 36 58 77 43 125 -15 50 -60 87 -116 95 l-44 7 -3 462 c-3 444 -4 463 -24 507 -31 66 -78 114 -142 146 l-57 28 -1265 3 c-1238 2 -1266 2 -1294 -17z', fill: 'currentColor' },
    { d: 'M4512 4150 c-47 -11 -98 -49 -121 -90 -42 -74 -39 -94 49 -365 77 -238 81 -252 70 -295 -14 -56 -54 -190 -132 -434 -79 -251 -79 -299 6 -374 93 -82 248 -56 310 51 25 43 168 486 212 656 39 151 36 176 -57 459 -45 136 -88 261 -96 277 -27 53 -75 95 -127 110 -54 16 -65 17 -114 5z', fill: 'currentColor' },
    { d: 'M6745 4146 c-57 -21 -116 -90 -142 -167 -171 -502 -174 -514 -149 -639 20 -96 199 -650 224 -695 45 -76 147 -118 232 -95 76 20 149 110 150 184 0 16 -33 133 -74 260 -116 361 -127 399 -128 436 0 33 25 116 121 392 23 64 41 129 41 145 0 15 -11 51 -24 80 -18 38 -35 58 -69 77 -56 33 -128 41 -182 22z', fill: 'currentColor' },
    { d: 'M1135 4131 c-46 -12 -87 -36 -122 -73 -59 -62 -63 -82 -63 -350 0 -275 5 -295 75 -357 81 -71 -8 -66 1205 -69 602 -2 1118 0 1146 3 73 9 151 58 189 119 l30 49 3 236 c2 157 -1 250 -8 277 -15 54 -60 107 -118 142 l-47 27 -1130 2 c-621 0 -1143 -2 -1160 -6z m2055 -421 l0 -180 -915 0 -915 0 0 180 0 180 915 0 915 0 0 -180z', fill: '#6A3906' },
    { d: 'M1321 3179 c-72 -29 -121 -97 -121 -168 0 -22 11 -71 25 -109 14 -38 25 -72 25 -76 0 -3 -99 -6 -219 -6 l-219 0 -31 -25 c-60 -51 -62 -132 -5 -186 l26 -24 1467 -3 1468 -2 34 23 c21 14 39 38 48 63 13 37 12 44 -5 79 -37 76 -46 78 -288 80 -119 1 -218 4 -222 7 -3 4 6 37 21 74 34 85 31 145 -10 203 -71 104 -252 109 -328 10 -14 -19 -43 -84 -65 -145 -22 -61 -45 -121 -51 -133 l-12 -21 -587 2 -586 3 -51 131 c-60 150 -83 186 -140 214 -44 21 -132 26 -174 9z', fill: '#6A3906' }
  ]
}

const goToPrivacy = () => {
  showUserMenu.value = false
  // 跳转到 /account 页面，并带上 tab=privacy 参数
  router.push({ path: '/account', query: { tab: 'privacy' } })
}

// ==================== 7. 监听与生命周期 ====================
watch(() => route.path, () => {
  activeDropdown.value = null
  showUserMenu.value = false
  // 路由跳转时尝试静默恢复状态
  if (localStorage.getItem('token') && !userStore.user) userStore.checkLoginStatus()
})

onMounted(async () => {
  // 恢复主题状态
  isDark.value = localStorage.getItem('theme') === 'dark'
  if (isDark.value) document.documentElement.classList.add('dark')

  // 初始化登录状态并静默刷新资料
  const authStatus = AuthManager.checkAuthStatus()
  if (authStatus.isLoggedIn && authStatus.isTokenValid) {
    if (!userStore.user) userStore.login(authStatus.user, authStatus.token)
    userStore.refreshUserInfo()
  } else {
    await userStore.checkLoginStatus()
  }

  // 绑定全局事件
  window.addEventListener('scroll', onScroll, { passive: true })
  window.addEventListener('user-login', handleUserLogin)
  window.addEventListener('click', () => showUserMenu.value = false)

  nextTick(() => {
    const el = document.querySelector('.navbar')
    if (el) navbarHeight.value = el.offsetHeight
  })
})

onUnmounted(() => {
  window.removeEventListener('scroll', onScroll)
  window.removeEventListener('user-login', handleUserLogin)
})
</script>

<template>
  <nav class="navbar" :class="{
    'navbar-active': shouldShowBackground,
    'navbar-hidden': !shouldShowNavbar
  }" @mouseenter="handleMouseEnter()" @mouseleave="handleMouseLeave">
    <div class="nav-content">
      <router-link to="/" class="logo">𝓥𝓮𝓻𝓲𝓽𝓪𝓼</router-link>

      <div class="menu">
        <!-- 导航项 -->
        <div v-for="item in navItems" :key="item.name" class="nav-item-wrapper"
          @mouseenter="item.isDropdown ? handleNavEnter(item.name) : null" @mouseleave="handleNavLeave">
          <router-link :to="item.path" class="nav-item">
            <svg v-if="item.paths" :viewBox="item.viewBox" class="nav-icon" xmlns="http://www.w3.org/2000/svg">
              <path v-for="(path, idx) in item.paths" :key="idx" :d="path.d" :fill="path.fill" />
            </svg>
            <span>{{ item.name }}</span>
          </router-link>

          <transition name="fade-slide">
            <div v-if="item.isDropdown && item.children && activeDropdown === item.name" class="dropdown-menu"
              @mouseenter="handleDropdownEnter" @mouseleave="handleNavLeave">
              <router-link v-for="child in item.children" :key="child.name" :to="child.path" class="dropdown-item">
                <svg v-if="child.paths" :viewBox="child.viewBox" class="dropdown-icon"
                  xmlns="http://www.w3.org/2000/svg">
                  <path v-for="(path, idx) in child.paths" :key="idx" :d="path.d" :fill="path.fill" />
                </svg>
                <span>{{ child.name }}</span>
              </router-link>
            </div>
          </transition>
        </div>

        <!-- 头像区域 -->
        <div class="avatar-container" @click.stop="isLoggedIn ? showUserMenu = !showUserMenu : router.push('/login')">
          <div class="avatar-frame" :class="{ 'active': showUserMenu }">

            <img v-if="isLoggedIn && userAvatar" :src="userAvatar" class="avatar-img" alt="User Avatar"
              @error="handleAvatarError" />

            <span v-else-if="isLoggedIn" class="avatar-text">
              {{ avatarText }}
            </span>

            <svg v-else class="avatar-icon" :viewBox="loginIcon.viewBox" xmlns="http://www.w3.org/2000/svg">
              <g :transform="loginIcon.gTransform">
                <path v-for="(path, idx) in loginIcon.paths" :key="idx" :d="path.d" :fill="path.fill" />
              </g>
            </svg>

          </div>

          <!-- 用户下拉菜单 -->
          <transition name="fade-slide">
            <div v-if="showUserMenu" class="user-dropdown-horizontal" @click.stop>
              <div class="user-header-horizontal">
                <div class="user-avatar-big rainbow-ring">
                  <img v-if="userAvatar" :src="userAvatar" class="avatar-img-big" alt="Avatar" />
                  <span v-else class="avatar-text-big">{{ avatarText }}</span>
                </div>

                <div class="user-info-right">
                  <div class="user-name-big">{{ nickname || username }}</div>
                  <div class="user-handle-big">{{ handle }}</div>
                </div>
              </div>

              <!-- 账号相关 -->
              <div class="dropdown-items">
                <router-link :to="`/profile/${userStore.user?.username}`" class="dropdown-item"
                  @click="showUserMenu = false">
                  <svg viewBox="0 0 24 24" class="menu-icon">
                    <path
                      d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"
                      fill="currentColor" />
                  </svg>
                  我的主页
                </router-link>

                <router-link to="/account" class="dropdown-item" @click="showUserMenu = false">
                  <svg viewBox="0 0 24 24" class="menu-icon">
                    <path
                      d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                  </svg>
                  个人中心
                </router-link>

                <!-- 👇 新增：管理员才能看到"后台管理" -->
                <router-link v-if="isAdmin" to="/admin" class="dropdown-item" @click="showUserMenu = false">
                  <svg viewBox="0 0 1024 1024" class="menu-icon" xmlns="http://www.w3.org/2000/svg">
                    <path
                      d="M879.177 626.688l-37.303-8.265a112.494 112.494 0 0 0-11.703-26.99l19.822-34.158c7.022-11.702 11.703-30.646 0-41.179l-20.992-21.211c-5.851-5.779-12.873-8.12-20.992-8.12s-15.287 2.341-22.162 6.95l-30.428 21.21a187.173 187.173 0 0 0-26.843-11.848l-8.119-37.523c-2.34-14.116-15.14-29.403-30.281-29.403h-29.184c-16.457 0-25.746 15.287-29.11 29.403l-9.436 37.523c-9.29 3.584-20.041 7.168-28.014 11.849l-33.865-21.285a54.272 54.272 0 0 0-22.162-5.778 29.989 29.989 0 0 0-20.992 8.265l-20.992 19.968c-11.703 11.776-7.022 29.477 0 41.18l20.992 35.254-10.533 24.723-37.303 8.338c-13.97 2.267-29.184 15.287-29.184 30.574v29.257c0 16.603 15.14 25.892 29.111 29.403l37.303 9.436c2.267 8.265 5.851 15.286 9.289 23.552l-20.846 35.181c-7.168 11.776-11.703 30.574 0 41.18l22.163 23.479c5.851 5.778 12.873 8.118 20.992 8.118a38.766 38.766 0 0 0 22.162-6.948l33.865-21.285c9.435 4.535 18.725 9.436 28.014 11.85l9.435 37.595c3.438 13.97 12.727 29.403 29.111 29.403h29.11c16.458 0 28.015-15.433 30.282-29.403l8.046-38.912c9.435-3.438 17.408-6.949 26.843-10.533l32.622 21.285c5.851 4.535 13.97 6.948 22.235 6.948a29.842 29.842 0 0 0 20.992-8.118l21.065-21.212c11.557-11.703 6.949-29.403 0-41.106l-19.821-34.231c3.291-8.119 8.119-16.603 10.532-24.722l37.45-9.436c13.823-3.584 29.11-12.873 29.11-29.403v-29.257c-2.34-16.311-16.164-28.087-30.28-31.598zM675.035 743.205a70.73 70.73 0 0 1 0-141.24c38.4 0 69.852 31.818 69.852 70.73 0 38.766-31.452 70.51-69.852 70.51z"
                      fill="currentColor" />
                    <path
                      d="M367.69 799.817h-0.586l-46.153-0.731c-64.366 0-125.586-25.308-171.813-71.315A242.615 242.615 0 0 1 77.97 555.447c0-64.951 25.308-126.098 71.241-172.252a240.786 240.786 0 0 1 117.687-65.316c3.804-20.7 9.875-40.74 18.14-59.758 14.263-34.158 35.108-65.243 61.952-91.867a292.279 292.279 0 0 1 91.867-62.025 293.595 293.595 0 0 1 244.882 8.923 291.109 291.109 0 0 1 100.352 84.919 36.645 36.645 0 0 1-7.68 51.2 36.937 36.937 0 0 1-51.273-7.826 217.234 217.234 0 0 0-74.825-63.269 219.575 219.575 0 0 0-183.003-6.656 217.82 217.82 0 0 0-115.054 115.054 208.677 208.677 0 0 0-16.31 65.828 36.571 36.571 0 0 1-32.696 33.353 170.277 170.277 0 0 0-152.137 169.692 169.91 169.91 0 0 0 170.423 170.496l39.57 0.658a32.402 32.402 0 0 1 6.583-0.658l0.073 0.731v-0.731a35.401 35.401 0 0 1 39.497 31.232 37.45 37.45 0 0 1-23.113 38.692 36.425 36.425 0 0 1-16.457 3.95z"
                      fill="currentColor" />
                  </svg>
                  后台管理
                </router-link>

                <div class="dropdown-item" @click="switchAccount">
                  <svg viewBox="0 0 1024 1024" class="menu-icon switch-account-icon">
                    <path
                      d="M736.305 546.133c9.752-19.504 4.876-39.01-14.629-48.762-24.38-14.628-48.762-24.38-73.143-34.133 53.638-43.886 92.648-107.276 92.648-185.295C746.057 151.162 638.781 48.762 512 48.762s-234.057 102.4-234.057 234.057c0 73.143 34.133 141.41 92.647 180.42C204.8 521.751 82.895 677.79 82.895 867.961c0 19.505 14.629 39.01 39.01 39.01s39.01-14.63 39.01-39.01c0-195.048 160.914-351.086 351.085-351.086 63.39 0 121.905 14.629 175.543 48.762 19.505 4.876 39.01 0 48.762-19.505zM355.962 282.82c0-87.771 68.267-160.914 156.038-160.914s156.038 73.143 156.038 156.038S599.771 438.857 512 438.857 355.962 365.714 355.962 282.82z"
                      fill="currentColor" />
                    <path
                      d="M560.762 707.048h390.095c14.629 0 29.257-9.753 34.133-24.381 4.877-14.629 4.877-29.257-9.752-39.01l-97.524-97.524c-14.628-14.628-39.01-14.628-53.638 0s-14.628 39.01 0 53.638l34.134 34.134H560.762c-19.505 0-39.01 14.628-39.01 39.01s19.505 34.133 39.01 34.133z m390.095 73.142H560.762c-14.629 0-29.257 9.753-34.133 24.381s-4.877 29.258 9.752 39.01l97.524 97.524c4.876 4.876 14.628 9.752 24.38 9.752s19.505-4.876 24.382-9.752c14.628-14.629 14.628-39.01 0-53.638l-34.134-34.134h302.324c19.505 0 39.01-14.628 39.01-39.01s-19.505-34.133-39.01-34.133z"
                      fill="currentColor" />
                  </svg>
                  切换账号<span class="arrow">></span>
                </div>

                <div class="dropdown-item sign-out" @click="handleLogout(); showUserMenu = false">
                  <svg viewBox="0 0 24 24" class="menu-icon">
                    <path
                      d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5-5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z" />
                  </svg>
                  退出登录
                </div>
              </div>

              <hr class="divider" />

              <!-- 设置相关 -->
              <div class="dropdown-items">
                <div class="dropdown-item" @click="goToPrivacy">
                  <svg viewBox="0 0 24 24" class="menu-icon">
                    <path
                      d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.05-.24-.24-.41-.47-.41h-3.84c-.24 0-1.24-.17-.47-.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.07-.47 0-.59.22L2.74 10.45c-.12.21-.07.48.12.61l2.03 1.58c-.05.3-.09.63-.09.94 0 .31.04.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.47.41h3.84c.24 0 .43-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.07.47 0 .59-.22l1.92-3.32c.12-.22.07-.48-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z" />
                  </svg>
                  你的数据
                </div>

                <div class="dropdown-item" @click="toggleThemeAndCloseMenu">
                  <svg viewBox="0 0 24 24" class="menu-icon">
                    <path
                      d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z" />
                  </svg>
                  外观: {{ isDark ? '深色模式' : '浅色模式' }}
                  <span class="arrow">></span>
                </div>

                <!-- 在模板中找到位置菜单项，修改为： -->
                <div class="dropdown-item" @click="handleLocationClick">
                  <svg viewBox="0 0 24 24" class="menu-icon">
                    <path
                      d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" />
                  </svg>
                  <div class="location-content">
                    <div class="location-label">位置</div>
                    <div class="location-value">
                      <template v-if="!isLoggedIn">
                        请先登录
                      </template>
                      <template v-else-if="userStore.isLoadingLocation">
                        <span class="loading-dots">正在获取位置</span>
                      </template>
                      <template v-else-if="userStore.location">
                        {{ userStore.location.text }}
                      </template>
                      <template v-else>
                        点击获取位置
                      </template>
                    </div>
                  </div>
                  <span class="arrow">↻</span>
                </div>

                <div class="dropdown-item">
                  <svg viewBox="0 0 24 24" class="menu-icon">
                    <path
                      d="M19.43 12.98c.04-.32.07-.64.07-.98 0-.34-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.06-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65-.63.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98 0 .33.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.06.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.63-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z" />
                  </svg>
                  设置
                </div>
              </div>
            </div>
          </transition>
        </div>
      </div>
    </div>
  </nav>
</template>

<style scoped>
/* ==================== 1. 导航栏主体 ==================== */
.navbar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 80px;
  z-index: 2000;
  /* 确保层级足够高 */

  /* 初始状态：透明背景，位于顶端 */
  background: transparent;
  border-bottom: 1px solid transparent;
  transform: translateY(0);

  /* 🔥 极其关键的丝滑过渡曲线 */
  transition:
    transform 0.4s cubic-bezier(0.165, 0.84, 0.44, 1),
    background 0.3s ease,
    backdrop-filter 0.3s ease,
    border-bottom 0.3s ease;
}

.navbar::before {
  content: '';
  position: absolute;
  bottom: -20px;
  /* 在导航栏下方延伸20px的隐形感应区 */
  left: 0;
  width: 100%;
  height: 20px;
}

.navbar-active {
  background: rgba(255, 255, 255, 0.1);
  /* 前景半透 */
  backdrop-filter: blur(15px) saturate(180%);
  -webkit-backdrop-filter: blur(15px) saturate(180%);
  border-bottom: 1px solid rgba(255, 255, 255, 0.15);
  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.05);
}

/* 深色模式适配 */
:global(html.dark) .navbar-active {
  background: rgba(0, 0, 0, 0.25);
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);
}

/* 关键：隐藏导航栏（向上滑出） */
.navbar-hidden {
  transform: translateY(-100%);
}

/* 可选：添加一点缓入效果 */
.navbar-hidden.navbar-active {
  transform: translateY(-100%);
}

.nav-content {
  max-width: 1200px;
  margin: 0 auto;
  padding: 10px 30px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

/* ==================== 2. Logo 样式 ==================== */
.logo {
  font-size: 1.8rem;
  font-weight: 700;
  font-family: 'Georgia', 'Times New Roman', serif;
  letter-spacing: 2px;
  text-decoration: none;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
  animation: logo-glow 3s ease-in-out infinite;
  transition: transform 0.3s ease;
}

.logo:hover {
  transform: scale(1.05);
}

@keyframes logo-glow {

  0%,
  100% {
    filter: drop-shadow(0 0 8px rgba(102, 126, 234, 0.6));
  }

  50% {
    filter: drop-shadow(0 0 20px rgba(240, 147, 251, 0.8));
  }
}

/* ==================== 3. 菜单容器 ==================== */
.menu {
  display: flex;
  align-items: center;
  gap: 35px;
}

/* ==================== 4. 导航项样式 ==================== */
.nav-item-wrapper {
  position: relative;
  height: 100%;
  display: flex;
  align-items: center;
}

.nav-item {
  color: white;
  text-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
  text-decoration: none;
  transition: all 0.3s ease;
  cursor: pointer;
  padding: 8px 0;
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 1rem;
  font-weight: 500;
  position: relative;
}

.nav-icon {
  width: 18px;
  height: 18px;
  transition: transform 0.3s ease;
}

.navbar-active .nav-item {
  color: var(--text-color);
  text-shadow: none;
}

.nav-item:hover {
  color: #3b82f6;
}

.nav-item:hover .nav-icon {
  transform: translateY(-2px);
}

.nav-item::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  width: 0;
  height: 2px;
  background-color: #3b82f6;
  transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1), left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  transform: translateX(-50%);
}

.nav-item:hover::after {
  width: 100%;
}

/* ==================== 5. 下拉菜单美化 ==================== */
.dropdown-menu {
  position: absolute;
  top: calc(100% + 8px);
  left: 50%;
  transform: translateX(-50%);
  min-width: 220px;
  /* 宽度加大，彻底杜绝文字换行 */
  padding: 12px 0;
  /* 上下间距更呼吸感 */
  margin-top: 0px;
  border-radius: 16px;
  /* 大圆角，和用户菜单统一 */
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.25);
  /* 🔥 新增：启用硬件加速，防止动画期间的微小卡顿 */
  will-change: opacity, transform;
  display: flex;
  flex-direction: column;
  z-index: 999;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(24px) saturate(180%);
  border: 1px solid rgba(0, 0, 0, 0.08);
}

.dropdown-menu::before {
  content: '';
  position: absolute;
  top: -6px;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-left: 6px solid transparent;
  border-right: 6px solid transparent;
  border-bottom: 6px solid rgba(255, 255, 255, 0.95);
}

:global(html.dark) .dropdown-menu {
  background: rgba(30, 30, 30, 0.95);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

:global(html.dark) .dropdown-menu::before {
  border-bottom-color: rgba(30, 30, 30, 0.95);
}

.nav-item-wrapper::after {
  content: '';
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  height: 12px;
  background: transparent;
  z-index: 89;
}

.dropdown-item {
  padding: 11px 24px 11px 56px !important;
  font-size: 0.94rem;
  display: flex;
  align-items: center;
  /* 保持垂直居中 */
  justify-content: flex-start;
  /* 改为左对齐 */
  position: relative;
  border-radius: 8px;
  transition: all 0.2s;
  text-decoration: none;
  margin-bottom: 2px;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  /* 移除 a 标签可能自带的下划线和颜色 */
  text-decoration: none !important;
  color: inherit;
  border: 1px solid transparent;
  /* 预留边框位置，防止 hover 抖动 */
}

/* 2. 统一悬停效果：实现你想要的绿色光影 */
.dropdown-item:hover {
    /* 背景微绿 */
    background: rgba(66, 184, 131, 0.08) !important;
    /* 文字变绿 */
    color: #42b883 !important;
    /* 关键：统一添加绿色外发光 (box-shadow) */
    box-shadow: 0 0 15px rgba(66, 184, 131, 0.2);
    /* 也可以使用 filter 实现更有质感的光晕 */
    filter: drop-shadow(0 0 2px rgba(66, 184, 131, 0.3));
    /* 向右微动，增加灵动感 */
    transform: translateX(5px);
    /* 如果想要那种边框发光感 */
    border-color: rgba(66, 184, 131, 0.2);
}

/* 3. 特殊处理：退出登录项使用红色光影 */
.dropdown-item.sign-out:hover {
    background: rgba(255, 95, 86, 0.08) !important;
    color: #ff5f56 !important;
    box-shadow: 0 0 15px rgba(255, 95, 86, 0.2);
    filter: drop-shadow(0 0 2px rgba(255, 95, 86, 0.3));
    border-color: rgba(255, 95, 86, 0.2);
}

/* 4. 确保图标也跟着变色 */
.dropdown-item:hover .menu-icon {
    opacity: 1;
    color: inherit;
    /* 让图标也带一点点光晕 */
    filter: drop-shadow(0 0 3px currentColor);
}


/* 确保箭头在右侧 */
.dropdown-item .arrow {
  margin-left: auto;
  color: #5f6368;
  font-weight: bold;
  font-size: 14px;
}

:global(html.dark) .dropdown-item .arrow {
  color: #9aa0a6;
}

/* 下拉菜单图标样式 */
.dropdown-icon {
  width: 18px;
  height: 18px;
  margin-right: 10px;
  flex-shrink: 0;
  transition: transform 0.2s ease;
}

.dropdown-item:hover .dropdown-icon {
  transform: scale(1.1);
}

.fade-slide-enter-active,
.fade-slide-leave-active {
  /* 🔥 优化：进入要快(0.2s)，离开稍微慢一点点(0.25s)显得优雅 */
  transition: opacity 0.2s ease-out, transform 0.2s cubic-bezier(0.165, 0.84, 0.44, 1);
}

.fade-slide-enter-from,
.fade-slide-leave-to {
  opacity: 0;
  /* 🔥 优化：位移距离改小一点，越小越感觉响应快 */
  transform: translate(-50%, 8px);
}

/* ==================== 6. 头像框 & 用户下拉菜单（YouTube风格） ==================== */
.avatar-container {
  position: relative;
  cursor: pointer;
  display: flex;
  align-items: center;
}

.avatar-frame {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  border: 2px solid rgba(255, 255, 255, 0.8);
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(5px);
  overflow: hidden;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: all 0.3s ease;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
  padding: 4px;
}

.navbar-active .avatar-frame {
  border-color: rgba(0, 0, 0, 0.1);
}

:global(html.dark) .navbar-active .avatar-frame {
  border-color: rgba(255, 255, 255, 0.2);
  background: rgba(255, 255, 255, 0.1);
}

.avatar-frame:hover {
  transform: scale(1.1);
  box-shadow: 0 6px 15px rgba(59, 130, 246, 0.3);
  border-color: #3b82f6;
}

.avatar-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%;
  display: block;
}

.avatar-text {
  font-size: 1.2rem;
  font-weight: 600;
  color: #1296db;
  user-select: none;
  text-transform: uppercase;
}

.avatar-icon {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

/* 新增：handle 行样式（完全模仿 YouTube 的灰色小字） */
.user-handle-big {
  font-size: 0.9rem;
  color: #5f6368;
  margin-bottom: 16px;
  font-weight: 400;
}

/* 新增：右边箭头（完全模仿 YouTube 菜单里的 > ） */
.arrow {
  float: right;
  color: #5f6368;
  font-weight: bold;
  margin-top: 2px;
}

/* 深色模式下箭头颜色同步 */
:global(html.dark) .arrow {
  color: #9aa0a6;
}

/* 用户下拉菜单 */
.user-dropdown {
  position: absolute;
  top: 56px;
  right: 0;
  width: 320px;
  background: rgba(255, 255, 255, 0.92);
  /* 浅色模式：高透明白 */
  backdrop-filter: blur(24px) saturate(180%);
  /* 超强磨砂感 */
  border-radius: 16px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  z-index: 1000;
  overflow: hidden;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

:global(html.dark) .user-dropdown {
  background: rgba(28, 28, 28, 0.96);
  /* 深色模式：极深灰 */
  border: 1px solid rgba(255, 255, 255, 0.15);
}

/* 图标样式（Material Design 标准大小 + 颜色自动适配） */
.menu-icon {
  width: 20px;
  height: 20px;
  margin-right: 16px;
  opacity: 0.7;
  fill: currentColor;
  flex-shrink: 0;
}

/* 头部更紧凑 */
.user-info-section {
  padding: 18px 24px 10px;
}

.user-avatar-big.rainbow-ring {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  margin: 0 auto 12px;
  background: linear-gradient(#fff, #fff) padding-box,
    conic-gradient(#ea4335, #fbbc05, #34a853, #4285f4, #ea4335) border-box;
  border: 4px solid transparent;
  overflow: hidden;
  display: flex;
  justify-content: center;
  align-items: center;
}

/* 彩虹环在深色模式下也更明显 */
:global(html.dark) .user-avatar-big.rainbow-ring {
  background: linear-gradient(#212121, #212121) padding-box,
    conic-gradient(#ea4335, #fbbc05, #34a853, #4285f4, #ea4335) border-box;
}

.avatar-img-big {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.avatar-text-big {
  font-size: 2.5rem;
  font-weight: 700;
  color: #202124;
  user-select: none;
}

:global(html.dark) .avatar-text-big {
  color: #fff;
}

/* 横向版下拉菜单（完全还原 YouTube 最新设计） */
.user-dropdown-horizontal {
  position: absolute;
  top: 56px;
  right: 0;
  width: 340px;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(32px) saturate(200%);
  border-radius: 20px;
  box-shadow: 0 12px 48px rgba(0, 0, 0, 0.35);
  z-index: 1000;
  overflow: hidden;
  border: 1px solid rgba(0, 0, 0, 0.08);
  padding: 12px 0;
}

:global(html.dark) .user-dropdown-horizontal {
  background: rgba(28, 28, 28, 0.97);
  border: 1px solid rgba(255, 255, 255, 0.15);
}

/* 横向头部布局 */
.user-header-horizontal {
  display: flex;
  align-items: center;
  padding: 16px 24px 16px 16px;
  gap: 16px;
}

.user-info-right {
  flex: 1;
  min-width: 0;
  /* 防止文字溢出 */
}

.user-name-big {
  font-size: 1.1rem;
  font-weight: 500;
  color: #202124;
  margin: 0;
  line-height: 1.3;
}

:global(html.dark) .user-name-big {
  color: #fff;
}

.user-handle-big {
  font-size: 0.9rem;
  color: #5f6368;
  margin-top: 2px;
}

:global(html.dark) .user-handle-big {
  color: #9aa0a6;
}

/* 其余保持不变，只微调间距更紧凑 */
.dropdown-items {
  padding: 4px 0;
}

.divider {
  margin: 8px 0;
  background: rgba(0, 0, 0, 0.08);
}

:global(html.dark) .divider {
  background: rgba(255, 255, 255, 0.12);
}

.dropdown-items {
  padding: 6px 0;
}

/* 收紧每一行间距（原14px → 10px，视觉上紧凑很多） */
.dropdown-items.tight {
  padding: 4px 0;
  /* 原8px → 4px */
}

.dropdown-items.tight .dropdown-item {
  padding: 10px 24px;
  /* 原14px → 10px */
  font-size: 0.95rem;
}

.dropdown-item {
  position: relative;
  padding: 11px 24px 11px 56px;
  /* 为左侧图标留出空间 */
  display: flex;
  align-items: center;
  font-size: 0.94rem;
}

/* 专为"切换账号"图标优化大小和位置（完美居中） */
.switch-account-icon {
  width: 22px !important;
  height: 22px !important;
  margin-right: 14px !important;
}

/* 第一个分组和第二个分组之间留点空隙（更接近原版感觉） */
.dropdown-items+.divider {
  margin-top: 8px;
}

:global(html.dark) .dropdown-item {
  color: #e8eaed;
}

:global(html.dark) .dropdown-item:hover {
  background: #3c4043;
}

.sign-out {
  color: #d93025 !important;
}

:global(html.dark) .sign-out {
  color: #f28b82 !important;
}

/* 动画 */
.fade-slide-enter-active,
.fade-slide-leave-active {
  transition: opacity 0.25s ease, transform 0.25s ease;
}

.fade-slide-enter-from,
.fade-slide-leave-to {
  opacity: 0;
  transform: translateY(-10px);
}

.manage-account {
  font-size: 0.875rem;
  color: #065fd4;
  margin-top: 8px;
  cursor: pointer;
}

:global(html.dark) .manage-account {
  color: #8ab4f8;
}

/* ==================== 8. 响应式 ==================== */
@media (max-width: 768px) {
  .nav-content {
    flex-direction: column;
    gap: 15px;
  }

  .menu {
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
  }
}

/* 位置菜单项样式 */
.location-content {
  flex: 1;
  min-width: 0;
  margin-right: 10px;
}

.location-label {
  font-size: 0.9rem;
  font-weight: 500;
  margin-bottom: 2px;
  color: #202124;
}

:global(html.dark) .location-label {
  color: #e8eaed;
}

.location-value {
  font-size: 0.8rem;
  color: #5f6368;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 180px;
}

:global(html.dark) .location-value {
  color: #9aa0a6;
}

/* 加载动画 */
.loading-dots::after {
  content: '...';
  animation: dots 1.5s steps(4, end) infinite;
  display: inline-block;
  width: 1.5em;
  text-align: left;
}

@keyframes dots {

  0%,
  20% {
    content: '';
  }

  40% {
    content: '.';
  }

  60% {
    content: '..';
  }

  80%,
  100% {
    content: '...';
  }
}

/* 刷新箭头动画 */
.dropdown-item:hover .arrow {
  animation: rotate 0.5s ease;
}

@keyframes rotate {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
}
</style>